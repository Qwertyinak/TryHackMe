


Active Directory Basics
	In a Windows domain, credentials are stored in a centralised repository called...
		Active Directory
	The server in charge of running the Active Directory services is called...
		Domain Controller
	Which group normally administrates all computers and resources in a domain?
		Domain Admins
	What would be the name of the machine account associated with a machine named TOM-PC?
		TOM-PC$
	Suppose our company creates a new department for Quality Assurance. What type of containers should we use to group all Quality Assurance users so that policies can be applied consistently to them?
		Organizational Units
	What was the flag found on Sophie's desktop?
		THM{thanks_for_contacting_support}
	The process of granting privileges to a user over some OU or other AD Object is called...
		delegation
	After organising the available computers, how many ended up in the Workstations OU?
		7
	Is it recommendable to create separate OUs for Servers and Workstations? (yay/nay)
		yay
	What is the name of the network share used to distribute GPOs to domain machines?
		sysvol
	Can a GPO be used to apply settings to users and computers? (yay/nay)
		yay
	Will a current version of Windows use NetNTLM as the preferred authentication protocol by default? (yay/nay)
		nay
	When referring to Kerberos, what type of ticket allows us to request further tickets known as TGS?
		Ticket Granting Ticket
	When using NetNTLM, is a user's password transmitted over the network at any point? (yay/nay)
		nay
	What is a group of Windows domains that share the same namespace called?
		Tree
	What should be configured between two domains for a user in Domain A to access a resource in Domain B?
		A Trust Relationship



Enumeration
	What command would you use to start the PowerShell interactive command line?
		powershell.exe
	In SSH key-based authentication, which key does the client need?
		private key
	What is the Linux distribution used in the VM?
		Ubuntu
	What is its version number?
		20.04.4
	What is the name of the user who last logged in to the system?
		randa
	What is the highest listening TCP port number?
		6667
	What is the program name of the service listening on it?
		inspircd
	There is a script running in the background. Its name starts with THM. What is the name of the script?
		THM-24765.sh
	What is the full OS Name?
		Microsoft Windows Server 2019 Datacenter
	What is the OS Version?
		10.0.17763
	How many hotfixes are installed on this MS Windows Server?
		30
	What is the lowest TCP port number listening on the system?
		22
	What is the name of the program listening on that port?
		sshd.exe
	Knowing that the domain name on the MS Windows Server of IP MACHINE_IP is redteam.thm, use dig to carry out a domain transfer. What is the flag that you get in the records?
		THM{DNS_ZONE}
	What is the name of the share available over SMB protocol and starts with THM? 
		THM{829738}
	Knowing that the community string used by the SNMP service is public, use snmpcheck to collect information about the MS Windows Server of IP MACHINE_IP. What is the location specified?
		THM{SNMP_SERVICE}
	What utility from Sysinternals Suite shows the logged-in users?
		PsLoggedOn



Red Team Fundamentals
Would vulnerability assessments prepare us to detect a real attacker on our networks? (Yay/Nay) 
Nay
During a penetration test, are you concerned about being detected by the client? (Yay/Nay)
Nay
Highly organised groups of skilled attackers are nowadays referred to as ...
Advanced Persistent Threats
The goals of a red team engagement will often be referred to as flags or...
crown jewels
During a red team engagement, common methods used by attackers are emulated against the target. Such methods are usually called TTPs. What does TTP stand for?
Tactics, techniques and procedures
The main objective of a red team engagement is to detect as many vulnerabilities in as many hosts as possible (Yay/Nay)
Nay
What cell is responsible for the offensive operations of an engagement?
Red Cell
What cell is the trusted agent considered part of?
White Cell
If an adversary deployed Mimikatz on a target machine, where would they be placed in the Lockheed Martin cyber kill chain?
Installation
What technique's purpose is to exploit the target's system to execute code?
Exploitation
Click the "View Site" button and follow the example engagement to get the flag
THM{RED_TEAM_ROCKS}



Red Team Engagements
What CIDR range is permitted to be attacked?
10.0.4.0/22
Is the use of white cards permitted? (Y/N)
Y
Are you permitted to access "*.bethechange.xyz?" (Y/N)
N
How many explicit restriction are specified?
3
What is the first access type mentioned in the document?
Phishing
Is the red team permitted to attack 192.168.1.0/24? (Y/N)
N
How long will the engagement last?
1 Month
How long is the red cell expected to maintain persistence?
3 Weeks
What is the primary tool used within the engagement?
Cobalt Strike
When will the engagement end? (MM/DD/YYYY)
11/14/2021
What is the budget the red team has for AWS cloud cost?
$1000
Are there any miscellaneous requirements for the engagement? (Y/N)
N
What phishing method will be employed during the initial access phase?
Spearphishing
What site will be utilized for communication between the client and red cell?
vectr.io
If there is a system outage, the red cell will continue with the engagement. (T/F)
F
When will the phishing campaign end? (mm/dd/yyyy)
10/23/2021
Are you permitted to attack 10.10.6.78? (Y/N)
N
When a stopping condition is encountered, you should continue working and determine the solution yourself without a team lead. (T/F)
F



Red Team Threat Intel
How many Command and Control techniques are employed by Carbanak?
2
What signed binary did Carbanak use for defense evasion?
Rundll32
What Initial Access technique is employed by Carbanak?
Valid Accounts
Once the chain is complete and you have received the flag, submit it below.
THM{7HR347_1N73L_12 _4w35om3}
What web shell is APT 41 known to use?
ASPXSpy
What LOLBAS (Living Off The Land Binaries and Scripts) tool does APT 41 use to aid in file transfers?
certutil
What tool does APT 41 use to mine and monitor SMS traffic?
MESSAGETAP



Red Team OPSEC
Click on View Site and follow through till you get the flag.
THM{OPSEC_CRITICAL_INFO}
Your red team uses THC-Hydra to find the password for a specific login page. Moreover, they are using the Metasploit framework on the same system as THC-Hydra. Would you consider this an OPSEC vulnerability? (Y/N)
Y
One of the red team members posts a photo of his cat every day. Would this be considered an OPSEC vulnerability? (Y/N)
N
Your red team went for dinner, took a photo, and tagged every team member on a popular social media platform. Would you consider this an OPSEC vulnerability? (Y/N)
Y
Your red team posts on its website a list of clients you regularly conduct red team exercises with. Would you consider this an OPSEC vulnerability? (Y/N)
Y
One of your red team members posted a photo of her morning coffee. Would you consider this an OPSEC vulnerability? (Y/N)
N
Your red team uses THC-Hydra to find the password for a specific login page. Moreover, they are using the Metasploit framework on the same system as THC-Hydra. Knowing that your target uses a properly configured Intrusion Detection System (IDS), would you consider this vulnerability as high risk? (Y/N)
Y
Click on View Site and follow through till you get the flag.
THM{OPSEC-RED-TEAM}



Intro to C2
What is the component's name that lives on the victim machine that calls back to the C2 server?
Agent
What is the beaconing option that introduces a random delay value to the sleep timer?
Jitter
What is the term for the first portion of a Staged payload?
Dropper
What is the name of the communication method that can potentially allow access to a restricted network segment that communicates via TCP ports 139 and 445?
SMB Beacon
Which listener should you choose if you have a device that cannot easily access the internet?
DNS
Which listener should you choose if you're accessing a restricted network segment?
SMB
Which listener should you choose if you are dealing with a Firewall that does protocol inspection?
HTTPS
What flag can be found after gaining Administrative access to the PC?
THM{bd6ea6c871dced619876321081132744}
What is the Administrator's NTLM hash?
c156d5d108721c5626a6a054d6e0943c
What flag can be found after gaining access to Ted's user account?
THM{217fa45e35f8353ffd04cfc0be28e760}
What is Ted's NTLM Hash?
2e2618f266da8867e5664425c1309a5c
What setting name that allows you to modify the User Agent field in a Meterpreter payload?
HttpUserAgent
What setting name that allows you to modify the Host header in a Meterpreter payload?
HttpHostHeader



Red Team Recon
When was thmredteam.com created (registered)? (YYYY-MM-DD) 
2021-09-24
To how many IPv4 addresses does clinic.thmredteam.com resolve?
2
To how many IPv6 addresses does clinic.thmredteam.com resolve?
2
How would you search using Google for xls indexed for http://clinic.thmredteam.com?
filetype:xls site:clinic.thmredteam.com
How would you search using Google for files with the word passwords for http://clinic.thmredteam.com?
passwords site:clinic.thmredteam.com
What is the shodan command to get your Internet-facing IP address?
shodan myip
How do you start recon-ng with the workspace clinicredteam? 
recon-ng -w clinicredteam
How many modules with the name virustotal exist?
2
There is a single module under hosts-domains. What is its name?
migrate_hosts
censys_email_address is a module that “retrieves email addresses from the TLS certificates for a company.” Who is the author?
Censys Team
What is the name of the transform that queries NIST’s National Vulnerability Database?
NIST NVD
What is the name of the project that offers a transform based on ATT&CK?
MISP Project



Weaponization
Which method is used to distribute payloads to a victim at social events?
USB Delivery
What is the flag? Hint: Check the user desktop folder for the flag!
THM{b4dbc2f16afdfe9579030a929b799719}



Password Attacks
Which type of password attack is performed locally?
Password cracking
What is the Juniper Networks ISG 2000 default password?
netscreen:netscreen
Run the following crunch command:crunch 2 2 01234abcd -o crunch.txt. How many words did crunch generate?
81
What is the crunch command to generate a list containing THM@! and output to a file named tryhackme.txt?
crunch 5 5 -t "THM^^" -o tryhackme.txt
Considering the following hash: 8d6e34f987851aa599257d3831a1af040886842f. What is the hash type?
sha-1
Perform a dictionary attack against the following hash: 8d6e34f987851aa599257d3831a1af040886842f. What is the cracked value? Use rockyou.txt wordlist.
sunshine
Perform a brute-force attack against the following MD5 hash: e48e13207341b6bffb7fb1622282247b. What is the cracked value? Note the password is a 4 digit number: [0-9][0-9][0-9][0-9]
1337
What syntax would you use to create a rule to produce the following: "S[Word]NN  where N is Number and S is a symbol of !@?
Az"[0-9][0-9]" ^[!@]
Can you guess the FTP credentials without brute-forcing? What is the flag?
THM{d0abe799f25738ad739c20301aed357b}
What is the password? Note that the password format is as follows: [symbol][dictionary word][0-9][0-9].
!multidisciplinary00
Perform a brute-forcing attack against the phillips account for the login page at http://MACHINE_IP/login-get using hydra? What is the flag?
THM{33c5d4954da881814420f3ba39772644}
Perform a rule-based password attack to gain access to the burgess account. Find the flag at the following website: http://MACHINE_IP/login-post/. What is the flag?
THM{f8e3750cc0ccbb863f2706a3b2933227}
Perform a password spraying attack to get access to the SSH://MACHINE_IP server to read /etc/flag. What is the flag?
THM{a97a26e86d09388bbea148f4b870277d}



Phishing
What type of psychological manipulation is phishing part of?
social engineering
What type of phishing campaign do red teams get involved in?
spear-phishing
What tactic can be used to find brands or people a victim interacts with?
OSINT
What should be changed on an HTML anchor tag to disguise a link?
anchor text
What part of a red team infrastructure can make a website look more authentic?
SSL/TLS Certificates
What protocol has TXT records that can improve email deliverability?
DNS
What tool can automate a phishing campaign and include analytics?
GoPhish
What is the password for Brian?
p4$$w0rd!
Do droppers tend to be malicious?
nay
What is better, using an expired or new domain? (old/new)
old
What is the term used to describe registering a similar domain name with a spelling error?
typosquatting
What can Microsoft Office documents contain, which, when executed can run computer commands?
macros
Which recent CVE caused remote code execution?
CVE-2021-40444
What is the flag from the challenge?
THM{I_CAUGHT_ALL_THE_PHISH}



The Lay of the land
Before going any further, ensure the attached machine is deployed and try what we discussed. Is the attached machine part of the AD environment? (Y|N)
Y
If it is part of an AD environment, what is the domain name of the AD?
thmredteam.com
Use the Get-ADUser -Filter * -SearchBase command to list the available user accounts within THM OU in the thmredteam.com domain. How many users are available?
6
Once you run the previous command, what is the UserPrincipalName (email) of the admin account?
thmadmin@thmredteam.com
Enumerate the attached Windows machine and check whether the host-based firewall is enabled or not! (Y|N)
N
Using PowerShell cmdlets such Get-MpThreat can provide us with threats details that have been detected using MS Defender. Run it and answer the following: What is the file name that causes this alert to record?
PowerView.ps1
Enumerate the firewall rules of the attached Windows machine. What is the port that is allowed under the THM-Connection rule?
17337
Finally, we can see it is listening on port 8080. Now try to apply what we discussed and find the port number for THM Service. What is the port number?
13337
Visit the localhost on the port you found in Question #1. What is the flag?
THM{S3rv1cs_1s_3numerat37ed}
Now enumerate the domain name of the domain controller, thmredteam.com, using the nslookup.exe, and perform a DNS zone transfer. What is the flag for one of the records?
THM{DNS-15-Enumerated!}



Enumeration
What command would you use to start the PowerShell interactive command line?
powershell.exe
In SSH key-based authentication, which key does the client need?
private key
What is the Linux distribution used in the VM?
Ubuntu
What is its version number?
20.04.4
What is the name of the user who last logged in to the system?
randa
What is the highest listening TCP port number?
6667
What is the program name of the service listening on it?
inspircd
There is a script running in the background. Its name starts with THM. What is the name of the script?
THM-24765.sh
What is the full OS Name?
Microsoft Windows Server 2019 Datacenter
What is the OS Version?
10.0.17763
How many hotfixes are installed on this MS Windows Server?
30
What is the lowest TCP port number listening on the system?
22
What is the name of the program listening on that port?
sshd.exe
Knowing that the domain name on the MS Windows Server of IP MACHINE_IP is redteam.thm, use dig to carry out a domain transfer. What is the flag that you get in the records?
THM{DNS_ZONE}
What is the name of the share available over SMB protocol and starts with THM?
THM{829738}
Knowing that the community string used by the SNMP service is public, use snmpcheck to collect information about the MS Windows Server of IP MACHINE_IP. What is the location specified?
THM{SNMP_SERVICE}
What utility from Sysinternals Suite shows the logged-in users?
PsLoggedOn



Windows Privilege Escalation
Users that can change system configurations are part of which group?
Administrators
The SYSTEM account has more privileges than the Administrator user (aye/nay)
aye
A password for the julia.jones user has been left on the Powershell history. What is the password?
ZuperCkretPa5z
A web server is running on the remote host. Find any interesting password on web.config files associated with IIS. What is the password of the db_admin user?
098n0x35skjD3
There is a saved password on your Windows credentials. Using cmdkey and runas, spawn a shell for mike.katz and retrieve the flag from his desktop.
THM{WHAT_IS_MY_PASSWORD}
Retrieve the saved password stored in the saved PuTTY session under your profile. What is the password for the thom.smith user?
CoolPass2021
What is the taskusr1 flag?
THM{TASK_COMPLETED}
Get the flag on svcusr1's desktop.
THM{AT_YOUR_SERVICE}
Get the flag on svcusr2's desktop.
THM{QUOTES_EVERYWHERE}
Get the flag on the Administrator's desktop.
THM{INSECURE_SVC_CONFIG}
Get the flag on the Administrator's desktop.
THM{SEFLAGPRIVILEGE}
Get the flag on the Administrator's desktop.
THM{EZ_DLL_PROXY_4ME}



Linux Fundamentals Part 1
Research: What year was the first release of a Linux operating system?
1991
If we wanted to output the text "TryHackMe", what would our command be?
echo TryHackMe
What is the username of who you're logged in as on your deployed Linux machine?
tryhackme
On the Linux machine that you deploy, how many folders are there?
4
Which directory contains a file?
folder4
What is the contents of this file?
Hello World!
Use the cd command to navigate to this file and find out the new current working directory. What is the path?
/home/tryhackme/folder4
Use grep on "access.log" to find the flag that has a prefix of "THM". What is the flag?
THM{ACCESS}
If we wanted to run a command in the background, what operator would we want to use?
&
If I wanted to replace the contents of a file named "passwords" with the word "password123", what would my command be?
echo password123 > password
Now if I wanted to add "tryhackme" to this file named "passwords" but also keep "passwords123", what would my command be
echo tryhackme >> password



Linux Fundamentals Part 2
What directional arrow key would we use to navigate down the manual page?
down
What flag would we use to display the output in a "human-readable" way?
-h
How would you create the file named "newnote"?
touch newnote
On the deployable machine, what is the file type of "unknown1" in "tryhackme's" home directory?
ASCII text
How would we move the file "myfile" to the directory "myfolder"
mv myfile /myfolder
What are the contents of this file?
THM{FILESYSTEM}
On the deployable machine, who is the owner of "important"?
user2
What would the command be to switch to the user "user2"?
su user2
Output the contents of "important", what is the flag?
THM{SU_USER2}
What is the directory path that would we expect logs to be stored in?
/var/log
What root directory is similar to how RAM on a computer works?
/tmp
Name the home directory of the root user
/root



Linux Fundamentals Part 3
Edit "task3" located in "tryhackme"'s home directory using Nano. What is the flag?
THM{TEXT_EDITORS}
What are the contents?
THM{WGET_WEBSERVER}
If we were to launch a process where the previous ID was "300", what would the ID of this new process be?
301
If we wanted to cleanly kill a process, what signal would we send it?
SIGTERM
Locate the process that is running on the deployed instance (MACHINE_IP). What flag is given?
THM{PROCESSES}
What command would we use to stop the service "myservice"?
systemctl stop myservice
What command would we use to start the same service on the boot-up of the system?
systemctl enable myservice
What command would we use to bring a previously backgrounded process back to the foreground?
fg
When will the crontab on the deployed instance (MACHINE_IP) run?
@reboot
What is the IP address of the user who visited the site?
10.9.232.111
What file did they access?
catsanddogs.jpg



Metasploit: Introduction
	What is the name of the code taking advantage of a flaw on the target system?
		Exploit
	What is the name of the code that runs on the target system to achieve the attacker's goal?	
		Payload
	What are self-contained payloads called?	
		Singles
	Is "windows/x64/pingback_reverse_tcp" among singles or staged payload? 	
		Singles
	How would you search for a module related to Apache?	
		search apache
	Who provided the auxiliary/scanner/ssh/ssh_login module?	
		todb
	How would you set the LPORT value to 6666?	
		set LPORT 6666
	How would you set the global value for RHOSTS to 10.10.19.23?	
		set RHOSTS 10.10.19.23
	What command would you use to clear a set payload?	
		unset payload
	What command do you use to proceed with the exploitation phase?	
		exploit



Hydra
	Use Hydra to bruteforce molly's web password. What is flag 1?
		THM{2673a7dd116de68e85c48ec0b1f2612e}
	Use Hydra to bruteforce molly's SSH password. What is flag 2?
		THM{c8eeb0468febbadea859baeb33b2541b}










